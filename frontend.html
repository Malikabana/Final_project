<!DOCTYPE html>
<html>
<head>
  <title>Multiplayer Game Hub</title>
</head>
<body>
  <h2>Register</h2>
  <input type="text" id="regUsername" placeholder="Username">
  <input type="email" id="regEmail" placeholder="Email">
  <input type="password" id="regPassword" placeholder="Password">
  <button onclick="register()">Register</button>

  <h2>Login</h2>
  <input type="email" id="loginEmail" placeholder="Email">
  <input type="password" id="loginPassword" placeholder="Password">
  <button onclick="login()">Login</button>

  <h2>Actions</h2>
  <button onclick="getMe()">/me</button>
  <button onclick="getStats()">/stats</button>
  <button onclick="getProfile()">/profile</button>
  <button onclick="getPreferences()">/preferences</button>

  <pre id="output"></pre>

  <script>
    let token = '';

    function display(data) {
      document.getElementById('output').textContent = JSON.stringify(data, null, 2);
    }

    function register() {
      const username = document.getElementById('regUsername').value;
      const email = document.getElementById('regEmail').value;
      const password = document.getElementById('regPassword').value;

      fetch('http://localhost:3000/auth/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username, email, password })
      })
      .then(res => res.json())
      .then(data => display(data))
      .catch(err => console.error(err));
    }

    function login() {
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;

      fetch('http://localhost:3000/auth/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
      })
      .then(res => res.json())
      .then(data => {
        if (data.token) {
          token = data.token;
          display({ message: 'Login successful', token });
        } else {
          display(data);
        }
      })
      .catch(err => console.error(err));
    }

    function getMe() {
      fetch('http://localhost:3000/me', {
        headers: { Authorization: 'Bearer ' + token }
      })
      .then(res => res.json())
      .then(data => display(data));
    }

    function getStats() {
      fetch('http://localhost:3000/stats', {
        headers: { Authorization: 'Bearer ' + token }
      })
      .then(res => res.json())
      .then(data => display(data));
    }

    function getProfile() {
      fetch('http://localhost:3000/profile', {
        headers: { Authorization: 'Bearer ' + token }
      })
      .then(res => res.json())
      .then(data => display(data));
    }

    function getPreferences() {
      fetch('http://localhost:3000/preferences', {
        headers: { Authorization: 'Bearer ' + token }
      })
      .then(res => res.json())
      .then(data => display(data));
    }
  </script>
</body>
</html>
